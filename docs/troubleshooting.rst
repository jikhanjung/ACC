문제 해결
=========

일반적인 오류
--------------

오류: "Matrix is not symmetric"
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**원인**: CSV 파일의 [i,j]와 [j,i] 값이 다름

**해결**:

1. CSV 파일을 Excel로 열기
2. 대칭성 확인: ``A[i][j] == A[j][i]``
3. 틀린 값 수정
4. 다시 저장 후 로드

**예방**: Excel에서 수식으로 대칭성 보장

.. code-block:: text

   =INDEX($B$2:$G$7, COLUMN()-1, ROW()-1)

오류: "Diagonal values must be 1.0"
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**원인**: 대각선 (자기 자신과의 유사도)이 1.0이 아님

**해결**:

1. 대각선 셀 확인 (J-J, T-T, Y-Y, ...)
2. 모두 1.0으로 수정

오류: "Labels do not match"
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**원인**: Local와 Global matrix의 라벨이 다름

**해결**:

1. 두 CSV 파일의 첫 행과 첫 열 비교
2. 라벨 이름과 순서를 동일하게 수정

예시:

.. code-block:: text

   # Local: J, T, Y, N, O, Q
   # Global:   J, T, Y, N, Q, O  ← 순서 다름

   → Global를 J, T, Y, N, O, Q 순서로 재정렬

오류: "Value out of range"
~~~~~~~~~~~~~~~~~~~~~~~~~~~

**원인**: 유사도 값이 0.0 ~ 1.0 범위를 벗어남

**해결**:

1. 범위 밖의 값 찾기
2. 0.0 ~ 1.0 사이로 수정
3. 필요시 정규화 수행

GUI 문제
--------

Windows Defender 경고
~~~~~~~~~~~~~~~~~~~~~~~

**증상**: "Windows에서 PC를 보호했습니다" 메시지

**원인**: 서명되지 않은 실행파일에 대한 표준 경고

**해결**:

1. "추가 정보" 클릭
2. "실행" 버튼 클릭
3. 프로그램이 정상적으로 시작됨

**안전성**: 이 프로그램은 오픈소스이며 악성코드가 아닙니다.

프로그램이 시작되지 않음
~~~~~~~~~~~~~~~~~~~~~~~~

**증상**: 더블클릭 후 아무 일도 일어나지 않음

**해결**:

1. 명령 프롬프트(cmd)에서 실행하여 오류 확인:

   .. code-block:: batch

      C:\> ACC_v[버전].exe

2. 오류 메시지 확인 후 해당 문제 해결
3. 관리자 권한으로 실행 시도 (우클릭 → "관리자 권한으로 실행")

화면이 표시되지 않음
~~~~~~~~~~~~~~~~~~~~

**증상**: 프로그램 실행되지만 빈 화면

**해결**:

1. 프로그램 재시작
2. 다른 PC에서 테스트
3. 백신 프로그램 예외 설정 추가
4. 최신 버전 다운로드

Dendrogram이 생성되지 않음
~~~~~~~~~~~~~~~~~~~~~~~~~~~

**원인**: 데이터 부족 (최소 3개 영역 필요)

**해결**:

* 최소 3개 이상의 영역으로 데이터 준비

개발자용: Python 환경 문제
~~~~~~~~~~~~~~~~~~~~~~~~~~~

**PyQt5 설치 문제**:

.. code-block:: bash

   pip uninstall PyQt5
   pip install PyQt5==5.15.9

**matplotlib 오류**:

.. code-block:: bash

   pip uninstall matplotlib
   pip install matplotlib

성능 문제
----------

느린 시각화
~~~~~~~~~~~

**원인**: 대규모 데이터 (50개 이상 영역)

**해결**:

1. 데이터 필터링 (주요 영역만 선택)
2. 계층 레벨 제한
3. 하드웨어 업그레이드 고려

메모리 부족
~~~~~~~~~~~

**원인**: 대규모 매트릭스 (100x100 이상)

**해결**:

1. 데이터 샘플링
2. 배치 처리
3. 메모리 증설

CSV 파일 인코딩 문제
---------------------

한글 라벨이 깨짐
~~~~~~~~~~~~~~~~

**원인**: CSV 파일 인코딩 문제

**해결**:

Excel에서 "CSV UTF-8 (쉼표로 분리)" 형식으로 저장:

1. "다른 이름으로 저장"
2. 파일 형식: "CSV UTF-8 (쉼표로 분리)(*.csv)"
3. 저장

로그 및 디버그
--------------

개발자 모드 로그 확인
~~~~~~~~~~~~~~~~~~~~~

.. code-block:: bash

   python acc_gui.py

콘솔에서 상세 로그 확인:

* INFO: 일반 동작
* WARNING: 경고
* ERROR: 오류

문제 제보
---------

오류 발생 시 어떻게 해야 하나요?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. 오류 메시지 확인
2. 이 매뉴얼의 "문제 해결" 섹션 참조
3. 로그 확인 (콘솔 출력)
4. GitHub Issues에 문의

이슈 제보 시 포함할 내용
~~~~~~~~~~~~~~~~~~~~~~~~

* 오류 메시지 전문
* 사용한 CSV 파일 (샘플)
* Python 버전
* 라이브러리 버전 (``pip list``)

GitHub Issues 링크
~~~~~~~~~~~~~~~~~~~

https://github.com/your-github-username/ACC/issues

추가 도움말
-----------

* FAQ: :doc:`faq`
* 기본 사용법: :doc:`basic_usage`
* 데이터 형식: :doc:`data_format`

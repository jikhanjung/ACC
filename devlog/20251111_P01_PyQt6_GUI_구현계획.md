# 20251111 P01: ACC PyQt6 GUI 구현 계획

## 프로젝트 목표

ACC (Adaptive Cluster Circle) 알고리즘을 PyQt6를 사용한 GUI 애플리케이션으로 구현

## Phase 1: 기본 기능 구현

### 1단계 목표
- 두 개의 similarity matrix를 입력받기
- Concentric circles 시각화 생성

## 구현 계획

### 1. 애플리케이션 구조

```
acc_gui.py              # 메인 GUI 애플리케이션
├── MainWindow          # 메인 윈도우
├── MatrixInputWidget   # Similarity matrix 입력 위젯
├── VisualizationWidget # Concentric circles 그리기 위젯
└── ControlPanel        # 제어 패널
```

### 2. 필요한 주요 컴포넌트

#### 2.1 Similarity Matrix 입력 인터페이스
- **방식 1**: CSV/Excel 파일 업로드
- **방식 2**: 테이블 위젯에서 직접 편집
- **방식 3**: 텍스트 영역에 붙여넣기

**초기 구현**: 방식 1 (파일 업로드) + 방식 2 (테이블 편집)를 결합
- QTableWidget 사용하여 matrix 표시/편집
- "Load CSV" 버튼으로 파일 불러오기
- 두 개의 탭: "Subordinate Matrix", "Inclusive Matrix"

#### 2.2 Matrix → Dendrogram 변환
현재 acc_core.py는 DendroNode 구조를 입력으로 받는데, similarity matrix에서 dendrogram을 생성해야 함.

**필요한 작업**:
- scipy.cluster.hierarchy 사용
  - `linkage()`: similarity matrix → hierarchical clustering
  - Custom 함수: linkage 결과 → DendroNode 구조 변환

#### 2.3 시각화 위젯
- QPainter를 사용한 커스텀 그리기
- 또는 matplotlib을 PyQt6에 임베드 (FigureCanvas)

**초기 구현 추천**: matplotlib 사용
- 이유: 원/점/라벨 그리기가 간편
- FigureCanvasQTAgg 사용하여 PyQt6 통합

### 3. 데이터 플로우

```
[CSV 파일]
    ↓
[Pandas DataFrame]
    ↓
[Similarity Matrix (dict)]
    ↓
[scipy.cluster.hierarchy.linkage()]
    ↓
[DendroNode 구조]
    ↓
[build_acc()] - acc_core.py
    ↓
[Visualization] - matplotlib
```

### 4. GUI 레이아웃

```
┌─────────────────────────────────────────────────┐
│  ACC Visualizer                            [_][□][×] │
├─────────────────────────────────────────────────┤
│ ┌─────────────┐ ┌───────────────────────────┐ │
│ │ Input       │ │                           │ │
│ │             │ │                           │ │
│ │ [Subordinate]│ │    Visualization         │ │
│ │ [Load CSV] │ │                           │ │
│ │ ┌─────────┐│ │                           │ │
│ │ │ Table   ││ │       [Circles]           │ │
│ │ │         ││ │                           │ │
│ │ └─────────┘│ │                           │ │
│ │             │ │                           │ │
│ │ [Inclusive] │ │                           │ │
│ │ [Load CSV] │ │                           │ │
│ │ ┌─────────┐│ │                           │ │
│ │ │ Table   ││ │                           │ │
│ │ │         ││ │                           │ │
│ │ └─────────┘│ │                           │ │
│ │             │ │                           │ │
│ │ [Generate] │ │                           │ │
│ └─────────────┘ └───────────────────────────┘ │
└─────────────────────────────────────────────────┘
```

### 5. 구현 단계

#### Step 1: 기본 윈도우 생성
- PyQt6 설치 확인
- MainWindow 클래스 생성
- 기본 레이아웃 구성

#### Step 2: Matrix 입력 UI
- QTableWidget으로 matrix 입력 테이블 생성
- CSV 파일 로드 기능
- Subordinate/Inclusive 두 개의 입력 영역

#### Step 3: Matrix → Dendrogram 변환 로직
- scipy 사용하여 hierarchical clustering
- linkage 결과를 DendroNode로 변환하는 헬퍼 함수 작성

#### Step 4: ACC 알고리즘 통합
- acc_core.py의 build_acc() 함수 호출
- 결과 데이터 구조 파싱

#### Step 5: 시각화
- matplotlib FigureCanvas 설정
- 원(circles) 그리기
- 점(members) 표시
- 라벨 추가

#### Step 6: 인터랙션 추가
- 줌/팬 기능
- 클러스터 선택 시 정보 표시
- Export 기능 (PNG, SVG)

## 기술 스택

### 필수 라이브러리
```
PyQt6              # GUI 프레임워크
matplotlib         # 시각화
scipy              # 계층적 클러스터링
pandas             # CSV 데이터 처리
numpy              # 수치 연산
```

### 설치 명령
```bash
pip install PyQt6 matplotlib scipy pandas numpy
```

## 고려사항

### 1. Similarity vs Distance
- scipy.cluster.hierarchy는 distance matrix를 기대
- similarity matrix는 distance로 변환 필요: `distance = 1 - similarity`
- 또는 `distance = max(similarity) - similarity`

### 2. Matrix 검증
- 대칭 행렬인지 확인
- 대각선이 1 (또는 0)인지 확인
- 값의 범위 확인 (0~1)

### 3. 성능
- 대규모 데이터셋의 경우 계산 시간 표시
- QThread 사용하여 백그라운드 처리 고려

### 4. 사용자 경험
- 샘플 데이터 제공 (예제 CSV 파일)
- 에러 메시지 명확하게 표시
- 진행 상태 표시 (progress bar)

## 다음 단계 (Phase 2 이후)

- [ ] 덴드로그램 직접 입력/편집 기능
- [ ] 실시간 파라미터 조정 (unit 값 등)
- [ ] 다양한 시각화 옵션 (색상, 크기 등)
- [ ] 결과 데이터 내보내기 (CSV, JSON)
- [ ] 여러 데이터셋 비교 기능
- [ ] 애니메이션 효과 (클러스터 형성 과정)

## 참고사항

- 기존 acc_core.py는 수정하지 않고 그대로 import하여 사용
- GUI 코드는 별도 파일(acc_gui.py)로 분리
- 테스트용 샘플 데이터는 data/ 디렉토리에 저장
